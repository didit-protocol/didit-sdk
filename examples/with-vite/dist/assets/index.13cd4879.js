import{t as ye,e as G}from"./tslib.31db49d6.js";import{c as E,a as ge}from"./index.48221487.js";const ve="PARSE_ERROR",me="INVALID_REQUEST",we="METHOD_NOT_FOUND",Ee="INVALID_PARAMS",X="INTERNAL_ERROR",F="SERVER_ERROR",be=[-32700,-32600,-32601,-32602,-32603],O={[ve]:{code:-32700,message:"Parse error"},[me]:{code:-32600,message:"Invalid Request"},[we]:{code:-32601,message:"Method not found"},[Ee]:{code:-32602,message:"Invalid params"},[X]:{code:-32603,message:"Internal error"},[F]:{code:-32e3,message:"Server error"}},z=F;function Re(r){return be.includes(r)}function I(r){return Object.keys(O).includes(r)?O[r]:O[z]}function _e(r){const e=Object.values(O).find(o=>o.code===r);return e||O[z]}function Te(r,e,o){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${o} RPC url at ${e}`):r}var Oe={},v={};Object.defineProperty(v,"__esModule",{value:!0});v.isBrowserCryptoAvailable=v.getSubtleCrypto=v.getBrowerCrypto=void 0;function B(){return(E===null||E===void 0?void 0:E.crypto)||(E===null||E===void 0?void 0:E.msCrypto)||{}}v.getBrowerCrypto=B;function Q(){const r=B();return r.subtle||r.webkitSubtle}v.getSubtleCrypto=Q;function Ae(){return!!B()&&!!Q()}v.isBrowserCryptoAvailable=Ae;var m={};Object.defineProperty(m,"__esModule",{value:!0});m.isBrowser=m.isNode=m.isReactNative=void 0;function K(){return typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"}m.isReactNative=K;function Y(){return typeof process!="undefined"&&typeof process.versions!="undefined"&&typeof process.versions.node!="undefined"}m.isNode=Y;function De(){return!K()&&!Y()}m.isBrowser=De;(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ye.exports;e.__exportStar(v,r),e.__exportStar(m,r)})(Oe);function Pe(){const r=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return r+e}function Ce(r,e,o){return{id:o||Pe(),jsonrpc:"2.0",method:r,params:e}}function st(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Se(r,e,o){return{id:r,jsonrpc:"2.0",error:xe(e,o)}}function xe(r,e){return typeof r=="undefined"?I(X):(typeof r=="string"&&(r=Object.assign(Object.assign({},I(F)),{message:r})),typeof e!="undefined"&&(r.data=e),Re(r.code)&&(r=_e(r.code)),r)}class Z{}class it extends Z{constructor(e){super()}}class Le extends Z{constructor(){super()}}class Fe extends Le{constructor(e){super()}}const Be="^https?:",Ue="^wss?:";function je(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function ee(r,e){const o=je(r);return typeof o=="undefined"?!1:new RegExp(e).test(o)}function H(r){return ee(r,Be)}function at(r){return ee(r,Ue)}function ct(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}function te(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function ft(r){return te(r)&&"method"in r}function Me(r){return te(r)&&(Ne(r)||re(r))}function Ne(r){return"result"in r}function re(r){return"error"in r}class ut extends Fe{constructor(e){super(e),this.events=new G.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,o){this.events.on(e,o)}once(e,o){this.events.once(e,o)}off(e,o){this.events.off(e,o)}removeListener(e,o){this.events.removeListener(e,o)}async request(e,o){return this.requestStrict(Ce(e.method,e.params||[]),o)}async requestStrict(e,o){return new Promise(async(f,u)=>{if(!this.connection.connected)try{await this.open()}catch(i){u(i)}this.events.on(`${e.id}`,i=>{re(i)?u(i.error):f(i.result)});try{await this.connection.send(e,o)}catch(i){u(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Me(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}var x={exports:{}};(function(r,e){var o=typeof self!="undefined"?self:E,f=function(){function i(){this.fetch=!1,this.DOMException=o.DOMException}return i.prototype=o,new i}();(function(i){(function(d){var y={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function oe(t){return t&&DataView.prototype.isPrototypeOf(t)}if(y.arrayBuffer)var se=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ie=ArrayBuffer.isView||function(t){return t&&se.indexOf(Object.prototype.toString.call(t))>-1};function _(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function U(t){return typeof t!="string"&&(t=String(t)),t}function D(t){var n={next:function(){var s=t.shift();return{done:s===void 0,value:s}}};return y.iterable&&(n[Symbol.iterator]=function(){return n}),n}function h(t){this.map={},t instanceof h?t.forEach(function(n,s){this.append(s,n)},this):Array.isArray(t)?t.forEach(function(n){this.append(n[0],n[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(n){this.append(n,t[n])},this)}h.prototype.append=function(t,n){t=_(t),n=U(n);var s=this.map[t];this.map[t]=s?s+", "+n:n},h.prototype.delete=function(t){delete this.map[_(t)]},h.prototype.get=function(t){return t=_(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(_(t))},h.prototype.set=function(t,n){this.map[_(t)]=U(n)},h.prototype.forEach=function(t,n){for(var s in this.map)this.map.hasOwnProperty(s)&&t.call(n,this.map[s],s,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(n,s){t.push(s)}),D(t)},h.prototype.values=function(){var t=[];return this.forEach(function(n){t.push(n)}),D(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(n,s){t.push([s,n])}),D(t)},y.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function P(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function j(t){return new Promise(function(n,s){t.onload=function(){n(t.result)},t.onerror=function(){s(t.error)}})}function ae(t){var n=new FileReader,s=j(n);return n.readAsArrayBuffer(t),s}function ce(t){var n=new FileReader,s=j(n);return n.readAsText(t),s}function fe(t){for(var n=new Uint8Array(t),s=new Array(n.length),p=0;p<n.length;p++)s[p]=String.fromCharCode(n[p]);return s.join("")}function M(t){if(t.slice)return t.slice(0);var n=new Uint8Array(t.byteLength);return n.set(new Uint8Array(t)),n.buffer}function N(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:y.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:y.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():y.arrayBuffer&&y.blob&&oe(t)?(this._bodyArrayBuffer=M(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||ie(t))?this._bodyArrayBuffer=M(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=P(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?P(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ae)}),this.text=function(){var t=P(this);if(t)return t;if(this._bodyBlob)return ce(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(de)}),this.json=function(){return this.text().then(JSON.parse)},this}var ue=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function he(t){var n=t.toUpperCase();return ue.indexOf(n)>-1?n:t}function w(t,n){n=n||{};var s=n.body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,n.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!s&&t._bodyInit!=null&&(s=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new h(n.headers)),this.method=he(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&s)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(s)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};function de(t){var n=new FormData;return t.trim().split("&").forEach(function(s){if(s){var p=s.split("="),l=p.shift().replace(/\+/g," "),a=p.join("=").replace(/\+/g," ");n.append(decodeURIComponent(l),decodeURIComponent(a))}}),n}function le(t){var n=new h,s=t.replace(/\r?\n[\t ]+/g," ");return s.split(/\r?\n/).forEach(function(p){var l=p.split(":"),a=l.shift().trim();if(a){var A=l.join(":").trim();n.append(a,A)}}),n}N.call(w.prototype);function g(t,n){n||(n={}),this.type="default",this.status=n.status===void 0?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new h(n.headers),this.url=n.url||"",this._initBody(t)}N.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var pe=[301,302,303,307,308];g.redirect=function(t,n){if(pe.indexOf(n)===-1)throw new RangeError("Invalid status code");return new g(null,{status:n,headers:{location:t}})},d.DOMException=i.DOMException;try{new d.DOMException}catch{d.DOMException=function(n,s){this.message=n,this.name=s;var p=Error(n);this.stack=p.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function C(t,n){return new Promise(function(s,p){var l=new w(t,n);if(l.signal&&l.signal.aborted)return p(new d.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function A(){a.abort()}a.onload=function(){var T={status:a.status,statusText:a.statusText,headers:le(a.getAllResponseHeaders()||"")};T.url="responseURL"in a?a.responseURL:T.headers.get("X-Request-URL");var S="response"in a?a.response:a.responseText;s(new g(S,T))},a.onerror=function(){p(new TypeError("Network request failed"))},a.ontimeout=function(){p(new TypeError("Network request failed"))},a.onabort=function(){p(new d.DOMException("Aborted","AbortError"))},a.open(l.method,l.url,!0),l.credentials==="include"?a.withCredentials=!0:l.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&y.blob&&(a.responseType="blob"),l.headers.forEach(function(T,S){a.setRequestHeader(S,T)}),l.signal&&(l.signal.addEventListener("abort",A),a.onreadystatechange=function(){a.readyState===4&&l.signal.removeEventListener("abort",A)}),a.send(typeof l._bodyInit=="undefined"?null:l._bodyInit)})}return C.polyfill=!0,i.fetch||(i.fetch=C,i.Headers=h,i.Request=w,i.Response=g),d.Headers=h,d.Request=w,d.Response=g,d.fetch=C,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(f),f.fetch.ponyfill=!0,delete f.fetch.polyfill;var u=f;e=u.fetch,e.default=u.fetch,e.fetch=u.fetch,e.Headers=u.Headers,e.Request=u.Request,e.Response=u.Response,r.exports=e})(x,x.exports);var J=ge(x.exports);function Ie(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function q(r){return typeof r=="string"?r:JSON.stringify(r)}const He={Accept:"application/json","Content-Type":"application/json"},Je="POST",V={headers:He,method:Je},$=10;class ht{constructor(e){if(this.url=e,this.events=new G.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!H(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,o){this.events.on(e,o)}once(e,o){this.events.once(e,o)}off(e,o){this.events.off(e,o)}removeListener(e,o){this.events.removeListener(e,o)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,o){this.isAvailable||await this.register();try{const f=q(e),i=await(await J(this.url,Object.assign(Object.assign({},V),{body:f}))).json();this.onPayload({data:i})}catch(f){this.onError(e.id,f)}}async register(e=this.url){if(!H(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const o=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=o||this.events.listenerCount("open")>=o)&&this.events.setMaxListeners(o+1),new Promise((f,u)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),u(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable=="undefined")return u(new Error("HTTP connection is missing or invalid"));f()})})}this.url=e,this.registering=!0;try{const o=q({id:1,jsonrpc:"2.0",method:"test",params:[]});await J(e,Object.assign(Object.assign({},V),{body:o})),this.onOpen()}catch(o){const f=this.parseError(o);throw this.events.emit("register_error",f),this.onClose(),f}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data=="undefined")return;const o=typeof e.data=="string"?Ie(e.data):e.data;this.events.emit("payload",o)}onError(e,o){const f=this.parseError(o),u=f.message||f.toString(),i=Se(e,u);this.events.emit("payload",i)}parseError(e,o=this.url){return Te(e,o,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>$&&this.events.setMaxListeners($)}}var c={};Object.defineProperty(c,"__esModule",{value:!0});c.getLocalStorage=c.getLocalStorageOrThrow=c.getCrypto=c.getCryptoOrThrow=Qe=c.getLocation=c.getLocationOrThrow=Ge=c.getNavigator=c.getNavigatorOrThrow=$e=c.getDocument=c.getDocumentOrThrow=c.getFromWindowOrThrow=c.getFromWindow=void 0;function b(r){let e;return typeof window!="undefined"&&typeof window[r]!="undefined"&&(e=window[r]),e}c.getFromWindow=b;function R(r){const e=b(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}c.getFromWindowOrThrow=R;function qe(){return R("document")}c.getDocumentOrThrow=qe;function Ve(){return b("document")}var $e=c.getDocument=Ve;function ke(){return R("navigator")}c.getNavigatorOrThrow=ke;function We(){return b("navigator")}var Ge=c.getNavigator=We;function Xe(){return R("location")}c.getLocationOrThrow=Xe;function ze(){return b("location")}var Qe=c.getLocation=ze;function Ke(){return R("crypto")}c.getCryptoOrThrow=Ke;function Ye(){return b("crypto")}c.getCrypto=Ye;function Ze(){return R("localStorage")}c.getLocalStorageOrThrow=Ze;function et(){return b("localStorage")}c.getLocalStorage=et;var dt=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),ne="%[a-f0-9]{2}",k=new RegExp("("+ne+")|([^%]+?)","gi"),W=new RegExp("("+ne+")+","gi");function L(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var o=r.slice(0,e),f=r.slice(e);return Array.prototype.concat.call([],L(o),L(f))}function tt(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(k)||[],o=1;o<e.length;o++)r=L(e,o).join(""),e=r.match(k)||[];return r}}function rt(r){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},o=W.exec(r);o;){try{e[o[0]]=decodeURIComponent(o[0])}catch{var f=tt(o[0]);f!==o[0]&&(e[o[0]]=f)}o=W.exec(r)}e["%C2"]="\uFFFD";for(var u=Object.keys(e),i=0;i<u.length;i++){var d=u[i];r=r.replace(new RegExp(d,"g"),e[d])}return r}var lt=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return rt(r)}},pt=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const o=r.indexOf(e);return o===-1?[r]:[r.slice(0,o),r.slice(o+e.length)]};export{ht as H,it as I,ut as J,dt as a,Oe as b,c,lt as d,q as e,Se as f,Qe as g,$e as h,Ge as i,at as j,ct as k,Ie as l,Te as m,ft as n,st as o,Pe as p,Ne as q,re as r,pt as s,Me as t,Ce as u};
